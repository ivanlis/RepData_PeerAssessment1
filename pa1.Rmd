---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

First, we check if the csv file is already unzipped. If it is not, unzip it into
the data directory (the directory will be created if necessary).

```{r echo=TRUE}
dataPathName <- "data/activity.csv"

if (!file.exists(dataPathName))
    unzip(zipfile = "./activity.zip", exdir = "data")
```

Now an R data frame is built out of the data from the file.

```{r echo=TRUE}
dataSet <- read.csv(dataPathName, na.strings = "NA", 
                    colClasses = c("integer", "Date", "integer"))
```

We will use the *dplyr* package for summarizing data.
Now we load it, and compute the total number of steps for each day observed.
By now, let's discard missing values. This way the days with no valid step numbers
will appear as having zero steps. Let's filter them out.

```{r echo=TRUE}
library(dplyr)
totalStepsByDay <- dataSet %>% group_by(date) %>% 
    summarize(totalSteps = sum(steps)) %>% filter(totalSteps > 0)
```

Using the *ggplot2* package, we build the histogram of total number of steps taken
each day. Let's set the bin width to 2000 steps.  
#TODO: ticks on axes, histogram size

```{r echo=TRUE}
library(ggplot2)
ggplot(data = totalStepsByDay, aes(totalStepsByDay$totalSteps)) +
    geom_histogram(binwidth = 2000, col = "red", fill = "green") + 
    labs(x = "steps per day")
```

## What is mean total number of steps taken per day?

Let's calculate the mean and median number of steps taken each day.
Like at the previous step, we ignore missing values.

```{r echo=TRUE}
meanTotal <- mean(totalStepsByDay$totalSteps)
medianTotal <- median(totalStepsByDay$totalSteps)
sprintf("mean: %f, median: %d", meanTotal, medianTotal)
```

## What is the average daily activity pattern?

Now we want to analyze the average number of steps taken for each 5 minute interval.
Based on the result, we build a plot describing the average daily pattern.

```{r echo=TRUE}
avgByInterval <- dataSet %>% group_by(interval) %>%
    summarize(avgSteps = mean(steps, na.rm = TRUE))

ggplot(data = avgByInterval, mapping = aes(x = interval, y = avgSteps)) +
    geom_line() + labs(x = "interval id", y = "average steps")
```

The 5 minute interval(s) with the maximum average number of steps taken
is found as

```{r echo=TRUE}
avgByInterval[avgByInterval$avgSteps == max(avgByInterval$avgSteps), "interval"]
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
